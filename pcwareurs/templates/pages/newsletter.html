{% extends "base.html" %}

{% block content %}

<div class="main">
    <h1 id="">Signup to newsletter</h1>
    <p>Want to stay up to date with whats happening with the PCwareRUs? Then subscribe to our newsletter and get regular updates on the best discounts!
        <br>(You only get a confirmation email. You're not actually subscribed to a newsletter.)
    </p>

    <form id="newsletter-form">
        <div class="form-col">
            <label for="signup-name">Name:</label>
            <input type="text" id="signup-name" name="name" required>
        </div>
        

        <div class="form-col">
            <label for="signup-email">Email:</label>
            <input type="email" id="signup-email" name="email" required>
        </div>

        <div id="newsletter-control-container">
            <input type="reset" value="Reset" class="btn">
            <input type="submit" value="Subscribe" id="signup-btn" class="btn">
        </div>
    </form>
</div>

<script>
    /**
 * Sends newsletter email
 * Code structure mostly generated by EmailJS
 * Notifications have been added
 */

document.querySelector("#newsletter-form").addEventListener('submit', function(event) {
   event.preventDefault();

   let button = document.querySelector("#signup-btn").value = "Sending...";

   const serviceID = 'service_0h6v5dc';
   const templateID = 'template_u63b9wu';

    //Send emailJS request
   emailjs.sendForm(serviceID, templateID, this)
    .then(() => {
        //Success response
        createNotification("Subscription successful!", NOTIFICATION_TYPES.success);
        button.value = "Success!";
        toggleNewsletterModal();
        button.value = "Subscribe";

    }, (err) => {
        //Error response
        createNotification(err.message, NOTIFICATION_TYPES.warning);
        console.log(JSON.stringify(err));
    });
});
</script>

{% endblock %}